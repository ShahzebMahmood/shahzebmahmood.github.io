# Pre-Push Checks for Jekyll Site

## Quick Validation Commands

### 1. Check YAML Syntax
```bash
# Check _config.yml
python3 -c "import yaml; yaml.safe_load(open('_config.yml'))" && echo "✓ Valid YAML"

# Check all post front matter
for file in _posts/*.md; do
  python3 -c "import yaml, sys; yaml.safe_load_all(open('$file'))" && echo "✓ $file" || echo "✗ $file"
done
```

### 2. Check for Common Issues
```bash
# Check for unclosed Liquid tags
grep -r "{% raw %}" _posts/*.md | grep -v "{% endraw %}" && echo "⚠ Unclosed raw tags found"

# Check for Liquid syntax in code blocks (should use HTML entities)
grep -r "{{ ." _posts/*.md | grep -v "&#123;" && echo "⚠ Liquid syntax in code blocks - should use HTML entities"

# Check for missing front matter
for file in _posts/*.md; do
  head -1 "$file" | grep -q "^---" || echo "✗ $file missing opening ---"
  tail -1 "$file" | grep -q "^---" || echo "✗ $file missing closing ---"
done
```

### 3. Full Build Test (Requires Ruby 3.1+)
```bash
# Install dependencies first
bundle install

# Run full build and test
bash tools/test.sh

# Or just build without testing
bundle exec jekyll build
```

### 4. Local Preview (Requires Ruby 3.1+)
```bash
# Install dependencies
bundle install

# Run local server
bash tools/run.sh

# Or manually
bundle exec jekyll serve -l
# Then visit http://localhost:4000
```

### 5. GitHub Actions Testing
Since your Ruby version is 2.6.10 (needs 3.1+), you can:
- Push to a feature branch first
- Let GitHub Actions build it
- Check the Actions tab for build errors
- Only merge to main if build succeeds

## Recommended Workflow

1. **Before committing:**
   ```bash
   # Quick syntax check
   python3 -c "import yaml; yaml.safe_load(open('_config.yml'))"
   ```

2. **Before pushing:**
   ```bash
   # Check for obvious issues
   grep -r "{{ ." _posts/*.md | grep -v "&#123;" && echo "⚠ Fix Liquid syntax"
   ```

3. **Push to feature branch:**
   ```bash
   git checkout -b fix/liquid-syntax
   git add .
   git commit -m "fix: Resolve Liquid syntax errors"
   git push origin fix/liquid-syntax
   ```

4. **Check GitHub Actions:**
   - Go to Actions tab
   - Verify build succeeds
   - Then merge to main

